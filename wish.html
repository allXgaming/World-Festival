<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading Wish...</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { background: #0f0c29; color: white; font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
    </style>
</head>
<body>
    <p>Loading your greeting...</p>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDHB9nPSUXju9iWNlaAsze1dsvZkD9iYLw",
            authDomain: "worldxfestival.firebaseapp.com",
            databaseURL: "https://worldxfestival-default-rtdb.firebaseio.com",
            projectId: "worldxfestival",
            storageBucket: "worldxfestival.firebasestorage.app",
            messagingSenderId: "1008928581835",
            appId: "1:1008928581835:web:345ec7913d27b15adad34e",
            measurementId: "G-L6Y4XTE78X"
        };

        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        async function loadWish() {
            const urlParams = new URLSearchParams(window.location.search);
            const itemId = urlParams.get('id');

            if (!itemId) {
                document.body.innerHTML = '<h1>Error: No item ID provided.</h1>';
                return;
            }

            // আমরা জানি না আইটেমটি কোন ক্যাটেগরিতে আছে, তাই সম্ভাব্য সব জায়গা থেকে খোঁজা হবে
            const categories = ['games', 'dailyUse', 'comingSoon'];
            let itemData = null;

            for (const category of categories) {
                const snapshot = await database.ref(`${category}/${itemId}`).once('value');
                if (snapshot.exists()) {
                    itemData = snapshot.val();
                    break; 
                }
            }

            if (itemData && itemData.htmlCode) {
                // htmlCode পাওয়ার সাথে সাথে বর্তমান পেজের সবকিছু মুছে দিয়ে নতুন কোড বসিয়ে দেওয়া হবে
                document.open();
                document.write(itemData.htmlCode);
                document.close();
            } else {
                document.body.innerHTML = `<h1>Sorry, the requested greeting could not be found.</h1>`;
            }
        }

        loadWish();
    </script>
</body>
</html>